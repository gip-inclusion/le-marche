{% extends "layouts/base.html" %}
{% load static %}

{% block page_title %}API{{ block.super }}{% endblock page_title %}

{% block breadcrumbs %}
<section>
    <div class="fr-container">
        <div class="fr-grid-row">
            <div class="fr-col-12">
                <nav class="c-breadcrumb c-breadcrumb--marche" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{{ HOME_PAGE_PATH }}">Accueil</a></li>
                        <li class="breadcrumb-item active" aria-current="page">API</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<section class="pt-4 pb-6 pb-lg-8">
    <div class="fr-container">
        <h1 class="h1-hero"><strong>API du March√© de l'inclusion</strong></h1>
        <h2 class="h2">L'API met √† disposition le r√©pertoire qualifi√© des structures d'insertion par l'activit√© √©conomique.</h2>

        <div class="fr-grid-row mt-5">
            <div class="fr-col-12">
                <h3 class="h1" id="doc">Conditions g√©n√©rales d'utilisation</h3>
                <p>
                    <a href="{{ CGU_API }}" target="_blank" rel="noopener">Lire les conditions g√©n√©rales d'utilisation de l'API du march√© de l'inclusion</a><i class="ri-external-link-line ml-1 font-weight-bold"></i>.
                </p>
            </div>
        </div>

        <div class="fr-grid-row mt-5">
            <div class="fr-col-12">
                <h3 class="h1" id="doc">Documentation</h3>
                <p>
                    Une documentation est disponible pour explorer et tester les possibilit√©s de l'API.
                </p>
                <p>
                    <a href="{% url 'api:swagger-ui' %}" target="_blank" class="btn btn-primary">üìö Acc√©der √† la documentation<i class="ri-external-link-line ml-1 font-weight-bold"></i></a>
                </p>
                <p>
                    L'API est aussi publi√©e sur <a href="{{ API_GOUV_URL }}" target="_blank" rel="noopener">api.gouv.fr</a><i class="ri-external-link-line ml-1 font-weight-bold"></i>.
                </p>
            </div>
        </div>

        <div class="fr-grid-row mt-5">
            <div class="fr-col-12">
                <h3 class="h1" id="auth">Authentification</h3>
                <p>Certaines donn√©es n√©cessitent un <strong>token</strong> (jeton utilisateur).</p>

                <h4 class="h2">Comment obtenir un token ?</h4>
                <ol>
                    <li><a href="{% url 'account_signup' %}" class="text-dark">Cr√©ez-vous un compte</a> sur le march√© de l'inclusion</li>
                    <li>Puis rendez-vous sur le <a href="{% url 'pages:contact' %}" class="text-dark">formulaire de contact</a> pour nous en faire la demande</li>
                    <li>Une fois g√©n√©r√©, le token appara√Ætra dans votre espace utilisateur</li>
                </ol>

                <h4 class="h2">Comment se servir du token ?</h4>

                <p>Rien de plus simple, il suffit de rajouter <strong><code>Bearer &lt;VOTRE-TOKEN&gt;</code></strong> dans le header "authorization" de vos requ√™tes API</p>
            </div>
        </div>

        <div class="fr-grid-row mt-5">
            <div class="fr-col-12">
                <h2 class="h1 mb-3">Derni√®res Nouveaut√©s</h2>
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th scope="fr-col">Date</th>
                            <th scope="fr-col">Version</th>
                            <th scope="fr-col">Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>22/12/2021</td>
                            <td>1.0</td>
                            <td>
                                - Publication de l'API sur <a href="{{ API_GOUV_URL }}" target="_blank" rel="noopener">api.gouv.fr</a>
                            </td>
                        </tr>
                        <tr>
                            <td>09/11/2021</td>
                            <td>0.13</td>
                            <td>
                                - Nouvelle ressource <code>/siae/slug/&lt;slug&gt;</code> pour avoir les d√©tails d'une structure par son slug (champ unique)<br />
                                - Modifi√© la ressource <code>/siae/siret/&lt;siret&gt;</code> pour g√©rer le cas de plusieurs structures partageant le m√™me siret (renvoie une liste dans ce cas l√†)<br />
                                - Rajout√© le champ <code>id</code> dans les r√©ponses des ressources <code>/siae</code>
                            </td>
                        </tr>
                        <tr>
                            <td>02/11/2021</td>
                            <td>0.12</td>
                            <td>
                                - Nouvelle ressource <code>/perimeters/autocomplete</code> d√©di√©e √† l'auto-compl√©tion des p√©rim√®tres<br />
                                - Possibilit√© de filtrer les structures par r√©seau<br />
                                - Ajout de champs suppl√©mentaires dans les d√©tails d'une structure
                            </td>
                        </tr>
                        <tr>
                            <td>27/10/2021</td>
                            <td>0.11</td>
                            <td>
                                - Migration du march√© termin√©e (l'application et l'API partagent maintenant le m√™me socle technique)<br />
                                - Les champs sont bascul√©s en anglais pour homog√©n√©iser avec le sch√©ma sous-jacent<br />
                                - L'url est maintenant finale (sans le sous-domaine <code>api.</code>).
                            </td>
                        </tr>
                        <tr>
                            <td>10/2021</td>
                            <td>0.10</td>
                            <td>
                                - Possibilit√© de filtrer les structures par secteur(s) d'activit√©
                            </td>
                        </tr>
                        <tr>
                            <td>10/2021</td>
                            <td>0.9</td>
                            <td>
                                - Nouvelle ressource <code>/siae/kinds</code><br/>
                                - Nouvelle ressource <code>/siae/presta-types</code><br/>
                                - Possibilit√© de filtrer les structures par type de prestation
                            </td>
                        </tr>
                        <tr>
                            <td>09/2021</td>
                            <td>0.8</td>
                            <td>
                                - Nouvelle ressource <code>/networks</code> pour r√©cup√©rer la liste des r√©seaux de l'inclusion
                            </td>
                        </tr>
                        <tr>
                            <td>09/2021</td>
                            <td>0.7</td>
                            <td>
                                - Le site du march√© de l'inclusion va prochainement rejoindre le socle technique de l'API<br/>
                                - L'acc√®s √† l'API est d√©plac√© dans le sous-dossiers <code>/api</code><br />
                                - La ressource secteurs d'activit√© a √©t√© re-architectur√© (les donn√©es sont d√©sormais mieux repr√©sent√©es)
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="fr-grid-row mt-5">
            <div class="fr-col-12">
                <div class="alert alert-info mt-3 mt-lg-0" role="status">
                    <i class="ri-information-line ri-xl"></i>
                    Une remarque ? Une question ? Vous souhaitez acc√©der √† d'avantage de donn√©es ?<br />
                    N'h√©sitez-pas √† <a href="{% url 'pages:contact' %}" class="text-dark">nous contacter</a>.
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
