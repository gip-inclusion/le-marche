{% extends "layouts/base.html" %}
{% load static %}

{% block title %}API{{ block.super }}{% endblock %}

{% block breadcrumbs %}
<section>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="c-breadcrumb c-breadcrumb--marche" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'pages:home' %}">Accueil</a></li>
                        <li class="breadcrumb-item active" aria-current="page">API</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<section class="pt-4 pb-6 pb-lg-8">
    <div class="container">
        <h1>API du march√© de l'inclusion</h1>
        <p class="lead">L'API met √† disposition le r√©pertoire qualifi√© des structures d'insertion par l'activit√© √©conomique.</p>

        <div class="alert alert-warning" role="alert">
            Service en cours de co-construction.<br />
            L'API devrait √™tre finalis√©e et publi√©e sur <a href="https://api.gouv.fr/" target="_blank" rel="noopener">api.gouv.fr</a> d'ici √† la fin de l'ann√©e 2021 !
        </div>

        <div class="row mt-5">
            <div class="col-12">
                <h2>Documentation</h2>
                <p>
                    Une documentation est disponible pour explorer et tester les possibilit√©s de l'API. Elle liste aussi les derni√®res nouveaut√©s.
                </p>
                <p>
                    <a href="{% url 'api:swagger-ui' %}" target="_blank" class="btn btn-outline-primary">üìö Acc√©der √† la documentation</a>
                </p>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-12">
                <h2>Authentification</h2>

                <p>Certaines donn√©es n√©cessitent un <strong>token</strong> (jeton utilisateur).</p>
                
                <h3>Comment obtenir un token ?</h3>
                <ol>
                    <li><a href="{% url 'auth:signup' %}" class="text-dark">Cr√©ez-vous un compte</a> sur le march√© de l'inclusion</li>
                    <li>Puis rendez-vous sur le <a href="{% url 'pages:contact' %}" class="text-dark">formulaire de contact</a> pour nous en faire la demande</li>
                    <li>Une fois g√©n√©r√©, le token appara√Ætra dans votre espace utilisateur</li>
                </ol>

                <h3>Comment se servir du token ?</h3>

                <p>Rien de plus simple, il suffit de rajouter <code>token=&lt;VOTRE-TOKEN&gt;</code> dans l'URL de vos requ√™tes API</p>
                <p>
                    Exemples :<br />
                    - <code>https://lemarche.inclusion.beta.gouv.fr/api/siae/?token=test</code><br />
                    - <code>https://lemarche.inclusion.beta.gouv.fr/api/siae/?department=38&kind=ESAT&token=test</code>
                </p>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-12">
                <h2 class="mb-3">Derni√®res Nouveaut√©s</h2>
                <div class="container">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">Version</th>
                                <th scope="col">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>09/11/2021</td>
                                <td>0.13</td>
                                <td>
                                    - Nouvelle ressource <code>/siae/slug/&lt;slug&gt;</code> pour avoir les d√©tails d'une structure par son slug (champ unique)<br />
                                    - Modifi√© la ressource <code>/siae/siret/&lt;siret&gt;</code> pour g√©rer le cas de plusieurs structures partageant le m√™me siret (renvoie une liste dans ce cas l√†)<br />
                                    - Rajout√© le champ <code>id</code> dans les r√©ponses des ressources <code>/siae</code>
                                </td>
                            </tr>
                            <tr>
                                <td>02/11/2021</td>
                                <td>0.12</td>
                                <td>
                                    - Nouvelle ressource <code>/perimeters/autocomplete</code> d√©di√©e √† l'auto-compl√©tion des p√©rim√®tres<br />
                                    - Possibilit√© de filtrer les structures par r√©seau<br />
                                    - Ajout de champs suppl√©mentaires dans les d√©tails d'une structure
                                </td>
                            </tr>
                            <tr>
                                <td>27/10/2021</td>
                                <td>0.11</td>
                                <td>
                                    - Migration du march√© termin√©e (l'application et l'API partagent maintenant le m√™me socle technique)<br />
                                    - Les champs sont bascul√©s en anglais pour homog√©n√©iser avec le sch√©ma sous-jacent<br />
                                    - L'url est maintenant finale (sans le sous-domaine <code>api.</code>).
                                </td>
                            </tr>
                            <tr>
                                <td>10/2021</td>
                                <td>0.10</td>
                                <td>
                                    - Possibilit√© de filtrer les structures par secteur(s) d'activit√©
                                </td>
                            </tr>
                            <tr>
                                <td>10/2021</td>
                                <td>0.9</td>
                                <td>
                                    - Nouvelle ressource <code>/siae/kinds</code><br/>
                                    - Nouvelle ressource <code>/siae/presta-types</code><br/>
                                    - Possibilit√© de filtrer les structures par type de prestation
                                </td>
                            </tr>
                            <tr>
                                <td>09/2021</td>
                                <td>0.8</td>
                                <td>
                                    - Nouvelle ressource <code>/networks</code> pour r√©cup√©rer la liste des r√©seaux de l'inclusion
                                </td>
                            </tr>
                            <tr>
                                <td>09/2021</td>
                                <td>0.7</td>
                                <td>
                                    - Le site du march√© de l'inclusion va prochainement rejoindre le socle technique de l'API<br/>
                                    - L'acc√®s √† l'API est d√©plac√© dans le sous-dossiers <code>/api</code><br />
                                    - La ressource secteurs d'activit√© a √©t√© re-architectur√© (les donn√©es sont d√©sormais mieux repr√©sent√©es)
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-12">
                <div class="alert alert-info mt-3 mt-lg-0" role="alert">
                    <span class="prof_icon"><img src="{% static 'img/prof_info_circle.svg' %}" /></span>
                    Une remarque ? Une question ? Vous souhaitez acc√©der √† d'avantage de donn√©es ?<br />
                    N'h√©sitez-pas √† <a href="{% url 'pages:contact' %}" class="text-dark">nous contacter</a>.
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
