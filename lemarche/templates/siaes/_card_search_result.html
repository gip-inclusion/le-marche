{% load static siae_sectors_display %}
{% load theme_inclusion %}

<div class="card c-card c-card--marche siae-card">
    <div class="row no-gutters">
        <div class="col-auto sc-img">
            <span class="p-3 d-inline-block">
                {% if siae.logo_url %}
                    <img class="img-fluid" src="{{ siae.logo_url }}" alt="Logo de la structure {{ siae.name }}" />
                {% else %}
                    <img class="img-fluid" src="{% static 'img/default-listing.png' %}" alt="{{ siae.name }}" />
                {% endif %}
            </span>
        </div>
        <div class="col">
            <div class="card-body">
                <a href="{% url 'siae:detail' siae.slug %}" class="text-decoration-none stretched -link">
                    <h2 class="mb-3 mr-5">
                        {{ siae.name_display }}
                        {% if not siae.user_count %}
                            <span class="fs-sm font-weight-normal">(bientôt inscrite sur le marché)</span>
                        {% endif %}
                    </h2>
                    <ul class="list-unstyled m-0 lh-sm row no-gutters">
                        <li class="sc-profile-type col-12 col-lg-6 pr-lg-2 d-flex" title="Type(s) de prestation">
                            <i class="ri-briefcase-4-line"></i>
                            <span class="ml-1">{{ siae.presta_type_display }}</span>
                        </li>
                        {% if siae.sectors %}
                        <li class="sc-profile-sectors col-12 col-lg-6 pl-lg-2 mb-3 mb-lg-0 d-flex" title="Secteur(s) d'activité">
                            <i class="ri-service-line"></i>
                            <span class="ml-1">{% siae_sectors_display siae display_max=3 current_search_query=current_search_query %}</span>
                        </li>
                        {% endif %}
                    </ul>
                    {% if user.is_authenticated %}
                        {% if from_profile or siae.in_user_favorite_list_count %}
                            <a href="#" id="favorite-remove-modal-btn" class="btn btn-favorite" data-toggle="modal" data-target="#favorite_item_remove_modal" data-siae-id="{{ siae.id }}" data-siae-slug="{{ siae.slug }}" data-siae-name-display="{{ siae.name_display }}" title="Dans votre liste d'achat">
                                <i class="ri-star-fill ri-xl"></i>
                            </a>
                        {% else %}
                            <a href="#" id="favorite-add-modal-btn" class="btn btn-favorite" data-toggle="modal" data-target="#favorite_item_add_modal" data-siae-id="{{ siae.id }}" data-siae-slug="{{ siae.slug }}" data-siae-name-display="{{ siae.name_display }}" title="Ajouter à votre liste d'achat">
                                <i class="ri-star-line ri-xl"></i>
                            </a>
                        {% endif %}
                    {% else %}
                        <a href="#" id="favorite-modal-btn" class="btn btn-favorite" data-toggle="modal" data-target="#login_or_signup_modal" data-next-params="{% url 'siae:search_results' %}?{{ current_search_query_escaped }}" title="Ajouter à votre liste d'achat">
                            <i class="ri-star-line ri-xl"></i>
                        </a>
                    {% endif %}
                </a>
            </div>
        </div>
    </div>
    <div class="card-footer">
        <a href="{% url 'siae:detail' siae.slug %}" class="text-decoration-none stretched-link">
            <ul class="list-unstyled m-0 lh-sm fs-sm row no-gutters">
                <li class="sc-profile-town col-12 col-md-4 pr-lg-2 mb-3 mb-md-0 d-flex justify-content-center" title="Situé à {{ siae.city }}">
                    <i class="ri-map-pin-line"></i>
                    <span class="ml-1">{{ siae.city }}</span>
                    {% if siae.is_qpv %}
                        <span class="badge badge-pill badge-emploi-lightest ml-1" title="Quartier prioritaire de la politique de la ville">QPV</span>
                    {% endif %}
                    {% if siae.is_zrr %}
                        <span class="badge badge-pill badge-emploi-lightest ml-1" title="Zone de revitalisation rurale">ZRR</span>
                    {% endif %}
                </li>
                <li class="sc-profile-town-work col-12 col-md-4 px-lg-2 mb-3 mb-md-0 d-flex justify-content-center" title="Intervient sur : {{ siae.geo_range_pretty_title }}">
                    <i class="ri-map-2-line"></i>
                    <span class="ml-1">{{ siae.geo_range_pretty_display }}</span>
                </li>
                {% if siae.kind %}
                    <li class="sc-profile-kind col-12 col-md-4 pl-lg-2 d-flex justify-content-center" title="Type de structure : {{ siae.get_kind_display }}">
                        <i class="ri-building-4-line"></i>
                        <span class="ml-1">{{ siae.get_kind_display }}</span>
                    </li>
                {% endif %}
            </ul>
        </a>
    </div>
</div>
